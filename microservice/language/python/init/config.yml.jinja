service:
  name: {{ name }}
  aggregate: src.aggregates.{{ aggregate }}
  injections:
    lock_pool: minos.common.PostgreSqlLockPool
    postgresql_pool: minos.common.PostgreSqlPool
    broker_publisher: minos.networks.BrokerPublisher
    broker_consumer: minos.networks.BrokerConsumer
    broker_pool: minos.networks.DynamicBrokerPool
    transaction_repository: minos.aggregate.PostgreSqlTransactionRepository
    event_repository: minos.aggregate.PostgreSqlEventRepository
    snapshot_repository: minos.aggregate.PostgreSqlSnapshotRepository
    saga_manager: minos.saga.SagaManager
    discovery: minos.networks.DiscoveryConnector
  services:
    - minos.networks.BrokerProducerService
    - minos.networks.BrokerConsumerService
    - minos.networks.BrokerHandlerService
    - minos.networks.RestService
    - minos.networks.PeriodicTaskSchedulerService
middleware:
  - minos.saga.transactional_command
services:
  - minos.aggregate.TransactionService
  - minos.aggregate.SnapshotService
  - minos.saga.SagaService
  - src.queries.{{ aggregate }}QueryService
  - src.commands.{{ aggregate }}CommandService
rest:
  host: {{ rest_host }}
  port: {{ rest_port }}
broker:
  host: {{ broker_host }}
  port: {{ broker_port }}
  queue:
    database: {{ name }}_db
    user: {{ database_user }}
    password: {{ database_password }}
    host: {{ database_host }}
    port: {{ database_port }}
    records: 1000
    retry: 2
repository:
  database: {{ name }}_db
  user: {{ database_user }}
  password: {{ database_password }}
  host: {{ database_host }}
  port: {{ database_port }}
snapshot:
  database: {{ name }}_db
  user: {{ database_user }}
  password: {{ database_password }}
  host: {{ database_host }}
  port: {{ database_port }}
saga:
  storage:
    path: ./{{ name }}.lmdb
discovery:
  client: minos.networks.MinosDiscoveryClient
  host: localhost
  port: 5567
